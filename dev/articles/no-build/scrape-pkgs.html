<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="gpttools">
<title>Scrape Package Sites • gpttools</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../../apple-touch-icon-60x60.png">
<script src="../../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../../pkgdown.js"></script><meta property="og:title" content="Scrape Package Sites">
<meta property="og:description" content="gpttools">
<meta property="og:image" content="https://jameshwade.github.io/gpttools/logo.png">
<meta name="robots" content="noindex">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../../index.html">gpttools</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">0.0.8.9014</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-addins">Addins</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-addins">
    <a class="dropdown-item" href="../../articles/chat-with-retrieval.html">Chat with Retrieval</a>
    <a class="dropdown-item" href="../../articles/scrape-pkgs.html">Scrape Packages</a>
    <a class="dropdown-item" href="../../articles/other-addins.html">Other Addins</a>
  </div>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-services">Services</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-services">
    <a class="dropdown-item" href="../../articles/openai.html">OpenAI</a>
    <a class="dropdown-item" href="../../articles/ollama.html">Local Models with Ollama</a>
    <a class="dropdown-item" href="../../articles/huggingface.html">HuggingFace</a>
    <a class="dropdown-item" href="../../articles/anthropic.html">Anthropic</a>
    <a class="dropdown-item" href="../../articles/azure.html">Azure OpenAI</a>
    <a class="dropdown-item" href="../../articles/google.html">Google AI Studio</a>
    <a class="dropdown-item" href="../../articles/perplexity.html">Perplexity</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/JamesHWade/gpttools/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../../logo.png" class="logo" alt=""><h1>Scrape Package Sites</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/JamesHWade/gpttools/blob/HEAD/vignettes/no-build/scrape-pkgs.Rmd" class="external-link"><code>vignettes/no-build/scrape-pkgs.Rmd</code></a></small>
      <div class="d-none name"><code>scrape-pkgs.Rmd</code></div>
    </div>

    
    
<p>A common use for RAG (Retrieval Augmented Generaation) is package
documentation. There are two addins to help you create package indices
to use with the “Chat with Retrieval” app. The “Select Packages” addin
launches a Shiny app that allows you to select packages and save your
selections. The “Scrape Packages” addin scrapes installed packages and
creates indices to use with the “Chat with Retrieval” app.</p>
<div class="section level2">
<h2 id="select-packages">Select Packages<a class="anchor" aria-label="anchor" href="#select-packages"></a>
</h2>
<div class="float">
<img src="images/pkg-selector-app.png" style="width:75.0%" alt="Select Packages App"><div class="figcaption">Select Packages App</div>
</div>
<p>The “Select Packages” addin launches a Shiny app that allows you to
select packages and save your selections. The app is launched by
executing the “Select Packages” addin. The addin is available in the
RStudio Addins menu. A set of default packages are pre-selected. You can
add or remove packages from the list. When you are done, click the “Save
Selected Packages” button to save your selections. Only installed
packages are available for selection.</p>
</div>
<div class="section level2">
<h2 id="scrape-packages">Scrape Packages<a class="anchor" aria-label="anchor" href="#scrape-packages"></a>
</h2>
<p>Run the scrape packages addin by executing the “Scrape Packages”
addin. The addin is available in the RStudio Addins menu. The addin will
scrape installed packages and create indices to use with the “Chat with
Retrieval” app. The addin will prompt you for confirmation before
proceeding. The scraping process will run in the background. You can
continue working in RStudio while the scraping process runs. You can
check on progress in the <code>Background Jobs</code> pane.</p>
<p>The addin <em>only</em> allows for embeddings to be created using
local models. If you want to use embeddings using OpenAI embeddings, you
will need to run the <code><a href="../../reference/scrape_pkg_sites.html">scrape_pkg_sites()</a></code> function directly.
See the section on <a href="#scraping-script">Scraping Script</a> for
more details. The reason for this is two fold: 1. some initial testing
shows that the time to create embeddings is comparable between local and
OpenAI embeddings, and 2. the OpenAI embeddings incur a cost for each
request. The cost is small, but it is not free.</p>
<div class="section level3">
<h3 id="scraping-script">Scraping Script<a class="anchor" aria-label="anchor" href="#scraping-script"></a>
</h3>
<p>Here is the script that runs when you execute the “Scrape Packages”
addin.
<code>options(repos = c(CRAN = "https://packagemanager.posit.co/all/latest"))</code>
sets global options in the R environment. In this case, it sets the
‘repos’ option to a custom CRAN repository URL, “<a href="https://packagemanager.posit.co/all/latest" class="external-link uri">https://packagemanager.posit.co/all/latest</a>”. This is
telling R to use a specific CRAN-like repository provided by Posit
Package Manager for installing packages. Posit Package manager offers
consistent and fast access to package downloads.
<code>options("repos")</code> is simply retrieving the current setting
of the ‘repos’ option. It doesn’t change the system state but would
print the ‘repos’ options to the console.
<code><a href="../../reference/scrape_pkg_sites.html">scrape_pkg_sites()</a></code> initiates the scraping of package
information from the defined CRAN repository.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/JamesHWade/gpttools" class="external-link">gpttools</a></span><span class="op">)</span></span>
<span><span class="fu">cli_inform</span><span class="op">(</span><span class="st">"Scraping package sites and creating an index for each."</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>repos <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>CRAN <span class="op">=</span> <span class="st">"https://packagemanager.posit.co/all/latest"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span><span class="st">"repos"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../../reference/scrape_pkg_sites.html">scrape_pkg_sites</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><code><a href="../../reference/scrape_pkg_sites.html">scrape_pkg_sites()</a></code> function is a scraping orchestrator
that checks for packages to scrape, prompts for user confirmation, and
then carries out the scraping operations by delegating to a helper
function. The packages to scrape are determined by the
<code>get_pkgs_to_scrape()</code> function. This function checks for
packages that are installed but not yet scraped. If there are no
packages to scrape, the function returns a message to the user. If there
are packages to scrape, the function prompts the user for confirmation.
If the user confirms, the function calls the
<code>scrape_pkg_site()</code> function to scrape the package site.</p>
<p>Here are the default packages that will be scraped.</p>
<pre><code><span><span class="co">#&gt;  [1] "broom"         "conflicted"    "cli"           "dbplyr"       </span></span>
<span><span class="co">#&gt;  [5] "dplyr"         "dtplyr"        "forcats"       "ggplot2"      </span></span>
<span><span class="co">#&gt;  [9] "googledrive"   "googlesheets4" "haven"         "hms"          </span></span>
<span><span class="co">#&gt; [13] "httr"          "jsonlite"      "lubridate"     "magrittr"     </span></span>
<span><span class="co">#&gt; [17] "modelr"        "pillar"        "purrr"         "ragg"         </span></span>
<span><span class="co">#&gt; [21] "readr"         "readxl"        "reprex"        "rlang"        </span></span>
<span><span class="co">#&gt; [25] "rstudioapi"    "rvest"         "stringr"       "tibble"       </span></span>
<span><span class="co">#&gt; [29] "tidyr"         "xml2"          "tidyverse"     "broom"        </span></span>
<span><span class="co">#&gt; [33] "cli"           "conflicted"    "dials"         "dplyr"        </span></span>
<span><span class="co">#&gt; [37] "ggplot2"       "hardhat"       "infer"         "modeldata"    </span></span>
<span><span class="co">#&gt; [41] "parsnip"       "purrr"         "recipes"       "rlang"        </span></span>
<span><span class="co">#&gt; [45] "rsample"       "rstudioapi"    "tibble"        "tidyr"        </span></span>
<span><span class="co">#&gt; [49] "tune"          "workflows"     "workflowsets"  "yardstick"    </span></span>
<span><span class="co">#&gt; [53] "tidymodels"    "shiny"         "bslib"         "shinyjs"      </span></span>
<span><span class="co">#&gt; [57] "golem"         "httr2"         "vetiver"       "plumber"      </span></span>
<span><span class="co">#&gt; [61] "embed"         "textrecipes"   "tidytext"      "devtools"     </span></span>
<span><span class="co">#&gt; [65] "usethis"       "roxygen2"      "pkgdown"       "testthat"     </span></span>
<span><span class="co">#&gt; [69] "knitr"         "rmarkdown"     "quarto"        "gptstudio"    </span></span>
<span><span class="co">#&gt; [73] "rstanarm"      "brms"          "bayesplot"</span></span></code></pre>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by James Wade.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
